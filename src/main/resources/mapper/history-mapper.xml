<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.igloosec.generator.mybatis.mapper.HistoryMapper">

    
    <select id="totalCnt" resultType="int">
        select count(*) from ${type}_hist
    </select>
    
    <select id="list" parameterType="com.igloosec.generator.history.HistoryResponse" 
    resultType="com.igloosec.generator.history.HistoryVO">
        <choose>
            <when test="type eq 'logger'">
                select b.name, a.* from 
				    (select 
				        *
				    from 
				        logger_hist
				    order by last_modified desc limit #{limit} offset #{offset}
				    ) a 
				left join 
				    logger b 
				on a.logger_id = b.id
            </when>
            <otherwise>
                select * from ${type}_hist order by last_modified desc limit #{limit} offset #{offset}
            </otherwise>
        </choose>
    </select>
    
</mapper>